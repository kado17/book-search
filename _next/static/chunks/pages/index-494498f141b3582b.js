(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{4654:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var r=n(9499),o=n(7294),c=n(2125),a=n(29),i=n(7794),s=n.n(i),u=n(9669),l=n.n(u),f=n(5055),p=n.n(f);function d(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){i=!0,c=e},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw c}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function(){var e=(0,a.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={transformResponse:[function(e){var t;return new(p().Parser)({async:!1,explicitArray:!1}).parseString(e,(function(e,n){t=n})),t}]},e.next=3,l().get(t,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(e){var t=e.match(/^\w+:(\w+)/);return t?t[1]:e},v=function(e){if("$"in e&&"_"in e&&"string"===typeof e._&&"object"===typeof e.$&&"xsi:type"in e.$){var t={};return t[b(e.$["xsi:type"])]=e._,t}return e},g=function(e){var t,n=[],r=d(e);try{var o=function(){var e=t.value,r={};Object.keys(e.recordData["dcndl_simple:dc"]).forEach((function(t){switch(t){case"$":case"rdfs:seeAlso":break;default:var n=b(t),o=e.recordData["dcndl_simple:dc"][t];if(Array.isArray(o)&&"string"!==typeof o){var c,a=[],i={},s=d(o);try{for(s.s();!(c=s.n()).done;){var u=c.value;"object"===typeof u?Object.assign(i,v(u)):"string"===typeof u&&a.push(u)}}catch(l){s.e(l)}finally{s.f()}0===a.length?r[n]=i:(0!==Object.keys(i).length&&a.push(i),r[n]=a)}else r[n]="object"===typeof o?v(o):o}})),n.push(r)};for(r.s();!(t=r.n()).done;)o()}catch(c){r.e(c)}finally{r.f()}return console.log("NDLDataShaping",n),n},m=function(){var e=(0,a.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://api.openbd.jp/v1/get?isbn=".concat(t),console.log(n),e.next=4,l().get(n);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=(0,a.Z)(s().mark((function e(t){var n,r,o,c,a,i,u,l,f,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),n=[],r=d(t),e.prev=3,r.s();case 5:if((o=r.n()).done){e.next=24;break}if(c=o.value,a={title:"",creator:"",publisher:"",cover:"",textContent:""},!("identifier"in c)||"object"!==typeof c.identifier||!("ISBN"in c.identifier)){e.next=20;break}return e.next=11,m(String(c.identifier.ISBN)).then((function(e){return null!==e.data[0]?e.data[0]:{}})).catch((function(e){return console.error(e),{}}));case 11:if(i=e.sent,0===Object.keys(i).length){e.next=20;break}return a.title=i.summary.title,a.creator=i.summary.author,a.publisher=i.summary.publisher,a.cover=i.summary.cover,"TextContent"in i.onix.CollateralDetail&&(a.textContent=i.onix.CollateralDetail.TextContent[0].Text),n.push(a),e.abrupt("continue",22);case 20:for(u=0,l=["title","creator","publisher"];u<l.length;u++)(f=l[u])in c&&(p=c[f],Array.isArray(p)?a[f]=String(p[0]):a[f]=String(p));n.push(a);case 22:e.next=5;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(3),r.e(e.t0);case 29:return e.prev=29,r.f(),e.finish(29);case 32:return console.log("convBookData",n),e.abrupt("return",n);case 34:case"end":return e.stop()}}),e,null,[[3,26,29,32]])})));return function(t){return e.apply(this,arguments)}}(),w=function(e){var t="https://iss.ndl.go.jp/api/sru?operation=searchRetrieve&onlyBib=true&maximumRecords=10&recordSchema=dcndl_simple&recordPacking=xml&query=mediatype=1 AND dpid=iss-ndl-opac",n="";return Object.keys(e).forEach((function(t){if(""!=e[t])if(["title","creator","publisher"].includes(t)){var r,o=d(e[t].split(" "));try{for(o.s();!(r=o.n()).done;){var c=r.value;" "!==c&&(n+=" AND ".concat(t,"=").concat(c))}}catch(s){o.e(s)}finally{o.f()}}else{var a;a=["from","until"].includes(t)?/^(\d{4}|\d{4}-\d{2}|\d{4}-\d{2}-\d{2})$/:/^(\d{10}|\d{13})$/;var i=e[t].match(a);if(!i)return console.log("".concat(t,"\u3067\u30a8\u30e9\u30fc")),"";n+=" AND ".concat(t,"=").concat(i[0])}})),""===n?"":(console.log(encodeURI(t+n),n),encodeURI(t+n))},k=function(){var e=(0,a.Z)(s().mark((function e(t){var n,r,o,c,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},""!==(r=w(t))){e.next=6;break}console.log("\u8981\u7d20\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"),e.next=26;break;case 6:return e.next=8,y(r).then((function(e){n=e.data})).catch((function(e){console.error(e),n={}}));case 8:if(console.log(n),!("searchRetrieveResponse"in n)){e.next=26;break}if(!("diagnostics"in(o=n.searchRetrieveResponse))){e.next=15;break}console.log("\u691c\u7d22\u4e2d\u306b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"),e.next=26;break;case 15:if(!("numberOfRecords"in o&&parseInt(o.numberOfRecords)<1)){e.next=19;break}console.log("\u7d50\u679c\u306a\u3057"),e.next=26;break;case 19:return console.log("\u5f15\u6570",o.records.record),c=g((i=o.records.record,Array.isArray(i)?i:[i])),e.next=23,x(c);case 23:return a=e.sent,console.log("RESULT",a),e.abrupt("return",a);case 26:case"end":return e.stop()}var i}),e)})));return function(t){return e.apply(this,arguments)}}(),j=n(5893);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=c.ZP.div.withConfig({displayName:"pages__Container",componentId:"sc-eccczk-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;min-height:100vh;padding:0 0.5rem;"]),A=c.ZP.div.withConfig({displayName:"pages__Box",componentId:"sc-eccczk-1"})(["display:flex;"]),C=c.ZP.label.withConfig({displayName:"pages__BoxLable",componentId:"sc-eccczk-2"})([""]),N=c.ZP.input.attrs((function(){return{type:"text"}})).withConfig({displayName:"pages__InputBox",componentId:"sc-eccczk-3"})([""]),P=c.ZP.button.withConfig({displayName:"pages__B",componentId:"sc-eccczk-4"})(["width:10vh;height:5vh;"]),I=function(){var e=(0,o.useState)({}),t=e[0],n=e[1];return(0,j.jsxs)(S,{children:[[["\u30bf\u30a4\u30c8\u30eb","title"],["\u8457\u8005","creator"],["\u51fa\u7248\u793e","publisher"],["\u958b\u59cb\u51fa\u7248\u5e74\u6708\u65e5","from"],["\u7d42\u4e86\u51fa\u7248\u5e74\u6708\u65e5","until"],["ISBN","isbn"]].map((function(e,t){return(0,j.jsxs)(A,{children:[(0,j.jsx)(C,{children:"".concat(e[0],"\uff1a")}),(0,j.jsx)(N,{onChange:function(t){n((function(n){return _(_({},n),{},(0,r.Z)({},e[1],t.target.value))}))}})]},t)})),(0,j.jsx)(P,{onClick:function(){return k(t)}})]})}},8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(4654)}])}},function(e){e.O(0,[562,774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);