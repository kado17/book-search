(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5006:function(e,n,t){"use strict";t.r(n);var r=t(9499),o=t(29),c=t(7794),a=t.n(c),i=t(9669),s=t.n(i),u=t(7294),l=t(2125),f=t(5055),p=t.n(f),d=t(5893);function h(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?h(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function v(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return g(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return g(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,c=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw c}}}}function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var b=l.ZP.div.withConfig({displayName:"pages__Container",componentId:"sc-eccczk-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;min-height:100vh;padding:0 0.5rem;"]),m=l.ZP.div.withConfig({displayName:"pages__Box",componentId:"sc-eccczk-1"})(["display:flex;"]),x=l.ZP.label.withConfig({displayName:"pages__BoxLable",componentId:"sc-eccczk-2"})([""]),w=l.ZP.input.attrs((function(){return{type:"text"}})).withConfig({displayName:"pages__InputBox",componentId:"sc-eccczk-3"})([""]),j=l.ZP.button.withConfig({displayName:"pages__B",componentId:"sc-eccczk-4"})(["width:10vh;height:5vh;"]);n.default=function(){var e=(0,u.useState)({}),n=e[0],t=e[1],c=function(){var e=(0,o.Z)(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={transformResponse:[function(e){var n;return new(p().Parser)({async:!1,explicitArray:!1}).parseString(e,(function(e,t){n=t})),n}]},e.next=3,s().get(n,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i=function(e){var n="https://iss.ndl.go.jp/api/sru?operation=searchRetrieve&onlyBib=true&maximumRecords=10&recordSchema=dcndl_simple&recordPacking=xml&query=mediatype=1",t="";return Object.keys(e).forEach((function(n){if(""!=e[n])if(["title","creator","publisher"].includes(n)){var r,o=v(e[n].split(" "));try{for(o.s();!(r=o.n()).done;){var c=r.value;" "!==c&&(t+=" AND ".concat(n,"=").concat(c))}}catch(s){o.e(s)}finally{o.f()}}else{var a;a=["from","until"].includes(n)?/^(\d{4}|\d{4}-\d{2}|\d{4}-\d{2}-\d{2})$/:/^(\d{10}|\d{13})$/;var i=e[n].match(a);if(!i)return console.log("".concat(n,"\u3067\u30a8\u30e9\u30fc")),"";t+=" AND ".concat(n,"=").concat(i[0])}})),""===t?"":(console.log(n+encodeURI(t),t),n+encodeURI(t))},l=function(e){var n=e.match(/^\w+:(\w+)/);return n?n[1]:e},f=function(e){if("object"===typeof e&&"$"in e&&"_"in e&&"string"===typeof e._&&"object"===typeof e.$){var n={};return n[l(e.$["xsi:type"])]=e._,n}return e},h=function(e){var n,t,r=[],o=v((t=e,Array.isArray(t)?t:[t]));try{var c=function(){var e=n.value,t={};Object.keys(e.recordData["dcndl_simple:dc"]).forEach((function(n){switch(n){case"$":case"rdfs:seeAlso":break;default:var r=l(n),o=e.recordData["dcndl_simple:dc"][n];if(Array.isArray(o)&&"string"!==typeof o){var c,a={},i=[],s=v(o);try{for(s.s();!(c=s.n()).done;){var u=c.value;"object"===typeof u?Object.assign(a,f(u)):"string"===typeof u&&i.push(u)}}catch(p){s.e(p)}finally{s.f()}0===i.length?t[r]=a:(0!==Object.keys(a).length&&i.push(a),t[r]=i)}else t[r]="object"===typeof o?f(o):o}})),r.push(t)};for(o.s();!(n=o.n()).done;)c()}catch(a){o.e(a)}finally{o.f()}return console.log(r),r},g=function(){var e=(0,o.Z)(a().mark((function e(n){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://api.openbd.jp/v1/get?isbn=".concat(n),console.log(t),r={},e.next=5,s().get(t).then((function(e){null!==e.data[0]&&(r=e.data[0])})).catch((function(e){console.error(e)}));case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),k=function(){var e=(0,o.Z)(a().mark((function e(n){var t,r,o,c,i,s,u,l,f,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(n),t=[],r=v(n),e.prev=3,r.s();case 5:if((o=r.n()).done){e.next=26;break}if(c=o.value,i={},!("identifier"in c)||!("ISBN"in c.identifier)){e.next=21;break}return e.next=11,g(String(c.identifier.ISBN));case 11:if(s=e.sent,0===Object.keys(s).length){e.next=21;break}return i.title=s.summary.title,i.creator=s.summary.author,i.publisher=s.summary.publisher,i.cover=s.summary.cover,"TextContent"in s.onix.CollateralDetail&&(i.textContent=s.onix.CollateralDetail.TextContent[0].Text),t.push(i),console.log("continue"),e.abrupt("continue",24);case 21:for(console.log("normal",c),u=0,l=["title","creator","publisher"];u<l.length;u++)(f=l[u])in c&&(p=c[f],Array.isArray(p)?i[f]=String(p[0]):i[f]=String(p));t.push(i);case 24:e.next=5;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(3),r.e(e.t0);case 31:return e.prev=31,r.f(),e.finish(31);case 34:return console.log(t),e.abrupt("return",t);case 36:case"end":return e.stop()}}),e,null,[[3,28,31,34]])})));return function(n){return e.apply(this,arguments)}}(),O=function(){var e=(0,o.Z)(a().mark((function e(n){var t,r,o,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},""!==(r=i(n))){e.next=6;break}console.log("\u8981\u7d20\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"),e.next=10;break;case 6:return e.next=8,c(r).then((function(e){t=e.data})).catch((function(e){console.error(e),t={}}));case 8:console.log(t),"searchRetrieveResponse"in t&&("diagnostics"in(o=t.searchRetrieveResponse)?console.log("\u691c\u7d22\u4e2d\u306b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"):"numberOfRecords"in o&&parseInt(o.numberOfRecords)<1?console.log("\u7d50\u679c\u306a\u3057"):(s=h(o.records.record),console.log("RESULT",k(s))));case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,d.jsxs)(b,{children:[[["\u30bf\u30a4\u30c8\u30eb","title"],["\u8457\u8005","creator"],["\u51fa\u7248\u793e","publisher"],["\u958b\u59cb\u51fa\u7248\u5e74\u6708\u65e5","from"],["\u7d42\u4e86\u51fa\u7248\u5e74\u6708\u65e5","until"],["ISBN","isbn"]].map((function(e,n){return(0,d.jsxs)(m,{children:[(0,d.jsx)(x,{children:"".concat(e[0],"\uff1a")}),(0,d.jsx)(w,{onChange:function(n){t((function(t){return y(y({},t),{},(0,r.Z)({},e[1],n.target.value))}))}})]},n)})),(0,d.jsx)(j,{onClick:function(){return O(n)}})]})}},8312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(5006)}])}},function(e){e.O(0,[562,774,888,179],(function(){return n=8312,e(e.s=n);var n}));var n=e.O();_N_E=n}]);