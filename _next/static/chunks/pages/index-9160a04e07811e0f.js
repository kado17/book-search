(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{1200:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return Z}});var n=t(9499),o=t(7294),c=t(2125),i="/book-search/_next/static/media/gray.8af2b8ec.jpg",a=t(29),s=t(7794),u=t.n(s),l=t(9669),f=t.n(l),p=t(5055),d=t.n(p);function h(e,r){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(!e)return;if("string"===typeof e)return g(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return g(e,r)}(e))||r&&e&&"number"===typeof e.length){t&&(e=t);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){a=!0,c=e},f:function(){try{i||null==t.return||t.return()}finally{if(a)throw c}}}}function g(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var y=function(){var e=(0,a.Z)(u().mark((function e(r){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={transformResponse:[function(e){var r;return new(d().Parser)({async:!1,explicitArray:!1}).parseString(e,(function(e,t){r=t})),r}]},e.next=3,f().get(r,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),b=function(e){var r=e.match(/^\w+:(\w+)/);return r?r[1]:e},m=function(e){if("$"in e&&"_"in e&&"string"===typeof e._&&"object"===typeof e.$&&"xsi:type"in e.$){var r={};return r[b(e.$["xsi:type"])]=e._,r}return e},v=function(e){var r,t=[],n=h(e);try{var o=function(){var e=r.value,n={};Object.keys(e.recordData["dcndl_simple:dc"]).forEach((function(r){switch(r){case"$":case"rdfs:seeAlso":break;default:var t=b(r),o=e.recordData["dcndl_simple:dc"][r];if(Array.isArray(o)&&"string"!==typeof o){var c,i=[],a={},s=h(o);try{for(s.s();!(c=s.n()).done;){var u=c.value;"object"===typeof u?Object.assign(a,m(u)):"string"===typeof u&&i.push(u)}}catch(l){s.e(l)}finally{s.f()}0===i.length?n[t]=a:(0!==Object.keys(a).length&&i.push(a),n[t]=i)}else n[t]="object"===typeof o?m(o):o}})),t.push(n)};for(n.s();!(r=n.n()).done;)o()}catch(c){n.e(c)}finally{n.f()}return console.log("NDLDataShaping",t),t},x=function(){var e=(0,a.Z)(u().mark((function e(r){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://api.openbd.jp/v1/get?isbn=".concat(r),console.log(t),e.next=4,f().get(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),j=function(){var e=(0,a.Z)(u().mark((function e(r){var t,n,o,c,i,a,s,l,f,p,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(r),t=[],n=h(r),e.prev=3,n.s();case 5:if((o=n.n()).done){e.next=25;break}if(c=o.value,i={title:"",creator:"",publisher:"",issued:"",cover:"",textContent:""},!("identifier"in c)||"object"!==typeof c.identifier||!("ISBN"in c.identifier)){e.next=21;break}return e.next=11,x(String(c.identifier.ISBN)).then((function(e){return null!==e.data[0]?e.data[0]:{}})).catch((function(e){return console.error(e),{}}));case 11:if(a=e.sent,0===Object.keys(a).length){e.next=21;break}return i.title=a.summary.title,i.creator=a.summary.author,i.publisher=a.summary.publisher,i.cover=a.summary.cover,i.issued=a.summary.pubdate,"TextContent"in a.onix.CollateralDetail&&(i.textContent=a.onix.CollateralDetail.TextContent[0].Text),t.push(i),e.abrupt("continue",23);case 21:for(s=0,l=["title","creator","publisher","issued"];s<l.length;s++)(f=l[s])in c&&(p=c[f],Array.isArray(p)?i[f]="".concat(String(p.join("  ")),"\u2026"):"issued"===f&&p instanceof Object&&!(p instanceof Array)?(d=Object.keys(p),i[f]=String(p[d[0]])):i[f]=String(p));t.push(i);case 23:e.next=5;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(3),n.e(e.t0);case 30:return e.prev=30,n.f(),e.finish(30);case 33:return console.log("convBookData",t),e.abrupt("return",t);case 35:case"end":return e.stop()}}),e,null,[[3,27,30,33]])})));return function(r){return e.apply(this,arguments)}}(),w=function(){var e=(0,a.Z)(u().mark((function e(r){var t,n,o,c,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},n={csResult:void 0,numberOfRecords:0,errMsg:""},""!==r){e.next=8;break}return console.log("\u8981\u7d20\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"),n.errMsg="\u8981\u7d20\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",e.abrupt("return",n);case 8:return e.next=10,y(r).then((function(e){t=e.data})).catch((function(e){console.error(e),t={}}));case 10:if(console.log(t),!("searchRetrieveResponse"in t)){e.next=34;break}if(!("diagnostics"in(o=t.searchRetrieveResponse))){e.next=19;break}return console.log("\u691c\u7d22\u4e2d\u306b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"),n.errMsg="\u691c\u7d22\u4e2d\u306b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u3066\u3044\u308b",e.abrupt("return",n);case 19:if(!("numberOfRecords"in o&&parseInt(o.numberOfRecords)<1)){e.next=25;break}return console.log("\u7d50\u679c\u306a\u3057"),n.errMsg="\u7d50\u679c\u306a\u3057",e.abrupt("return",n);case 25:return console.log("\u5f15\u6570",o.records.record),c=v((a=o.records.record,Array.isArray(a)?a:[a])),e.next=29,j(c);case 29:return i=e.sent,console.log("RESULT",i),n.csResult=i,n.numberOfRecords=parseInt(o.numberOfRecords),e.abrupt("return",n);case 34:case"end":return e.stop()}var a}),e)})));return function(r){return e.apply(this,arguments)}}(),k=t(5893);function _(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function O(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?_(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var C=c.ZP.div.withConfig({displayName:"pages__Container",componentId:"sc-eccczk-0"})(["display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;padding:0 0.5rem;background-color:gray;"]),I=c.ZP.div.withConfig({displayName:"pages__Box",componentId:"sc-eccczk-1"})(["display:flex;"]),N=c.ZP.label.withConfig({displayName:"pages__BoxLable",componentId:"sc-eccczk-2"})([""]),S=c.ZP.input.attrs((function(){return{type:"text"}})).withConfig({displayName:"pages__InputBox",componentId:"sc-eccczk-3"})([""]),P=c.ZP.button.withConfig({displayName:"pages__B",componentId:"sc-eccczk-4"})(["width:10vh;height:5vh;"]),R=c.ZP.div.withConfig({displayName:"pages__Frame",componentId:"sc-eccczk-5"})(["display:flex;flex-wrap:wrap;justify-items:center;width:75%;"]),A=c.ZP.div.withConfig({displayName:"pages__ItemContainer",componentId:"sc-eccczk-6"})(["display:flex;width:45%;margin:0 auto;background-color:white;border:1vh solid black;img{width:auto;height:100%;}"]),D=c.ZP.div.withConfig({displayName:"pages__ItemTextContainer",componentId:"sc-eccczk-7"})(["margin-right:5%;margin-left:5%;"]),Z=function(){var e=(0,o.useState)({}),r=e[0],t=e[1],c=(0,o.useState)(void 0),a=c[0],s=c[1],u=(0,o.useState)(0),l=(u[0],u[1]);return(0,k.jsxs)(C,{children:[[["\u30bf\u30a4\u30c8\u30eb","title"],["\u8457\u8005","creator"],["\u51fa\u7248\u793e","publisher"],["ISBN","isbn"]].map((function(e,r){return(0,k.jsxs)(I,{children:[(0,k.jsx)(N,{children:"".concat(e[0],"\uff1a")}),(0,k.jsx)(S,{onChange:function(r){t((function(t){return O(O({},t),{},(0,n.Z)({},e[1],r.target.value))}))}})]},r)})),(0,k.jsx)(P,{onClick:function(){var e=function(e){var r="https://iss.ndl.go.jp/api/sru?operation=searchRetrieve&onlyBib=true&recordSchema=dcndl_simple&recordPacking=xml&query=mediatype=1 AND dpid=iss-ndl-opac",t="";return Object.keys(e).forEach((function(r){if(""!=e[r])if(["title","creator","publisher"].includes(r)){var n,o=h(e[r].split(" "));try{for(o.s();!(n=o.n()).done;){var c=n.value;" "!==c&&(t+=" AND ".concat(r,"=").concat(c))}}catch(a){o.e(a)}finally{o.f()}}else{var i=e[r].match(/^(\d{10}|\d{13})$/);if(!i)return console.log("".concat(r,"\u3067\u30a8\u30e9\u30fc")),"";t+=" AND ".concat(r,"=").concat(i[0])}})),""===t?"":(t+="&maximumRecords=20",console.log(encodeURI(r+t),t),encodeURI(r+t))}(r);w(e).then((function(e){if(void 0===e)console.log("UNDEF");else{var r=e.csResult,t=e.numberOfRecords,n=e.errMsg;s(r),l(t),console.log(n)}}))}}),"string"===typeof a||void 0===a?"":(0,k.jsx)(R,{children:a.map((function(e,r){return(0,k.jsxs)(A,{children:[(0,k.jsx)("img",{src:""!==e.cover?e.cover:i,alt:"img"}),(0,k.jsxs)(D,{children:[(0,k.jsx)("h4",{children:e.title}),(0,k.jsx)("p",{children:e.textContent}),(0,k.jsx)("p",{children:e.creator}),(0,k.jsx)("p",{children:e.publisher}),(0,k.jsx)("p",{children:e.issued})]})]},r)}))})]})}},8312:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(1200)}])}},function(e){e.O(0,[562,774,888,179],(function(){return r=8312,e(e.s=r);var r}));var r=e.O();_N_E=r}]);